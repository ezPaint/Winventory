<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.simoncomputing.app.winventory.dao.EventToLocationDao">
    <!-- PROTECTED CODE -->
    
    <resultMap id="EventMapper" type="com.simoncomputing.app.winventory.domain.Event">
        <result column ="KEY"                 property = "key" />
        <result column ="DATE_CREATED"        property = "dateCreated" />
        <result column ="DESCRIPTION"         property = "description" />
        <result column ="CATEGORY"            property = "category" />
    </resultMap>
    
    <resultMap id="LocationMapper" type="com.simoncomputing.app.winventory.domain.Location">
        <result column ="KEY"                 property = "key" />
        <result column ="DESCRIPTION"         property = "description" />
        <result column ="IS_ACTIVE"           property = "isActive" />
        <result column ="ADDRESS_ID"          property = "addressId" />
    </resultMap>
    
    
	<!-- Gets all of the Events associated with a Hardware -->
	<select id='getEventsByLocationId' resultMap='EventMapper'>
		SELECT * FROM Event e
   		INNER JOIN Event_To_Location map ON e.key = map.event_id
		WHERE map.location_id = #{param1}
	</select>
	
	<select id='getLocationByEventId' resultMap='LocationMapper'>
		SELECT * FROM Location l
   		INNER JOIN Event_To_Location map ON l.key = map.location_id
		WHERE map.event_id = #{param1}
	</select>
	
	<insert id="link" parameterType="map">
        insert into EVENT_TO_LOCATION
        (
            EVENT_ID , LOCATION_ID
        )
        values
        (
            #{param1} , #{param2}
        )
    </insert>
    

    <delete id="unlink" parameterType="map">
        delete from EVENT_TO_LOCATION
        where location_ID=#{param2} AND event_id=#{param1};
    </delete>
    
</mapper>